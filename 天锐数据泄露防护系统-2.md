# SQL Injection Vulnerability in the findFileServerPage.do Interface of Tipray Data Leakage Prevention System

## Basic Overview
We have already learned about some basic information of the system developer and the reasons for authentication bypass in https://github.com/FightingLzn9/vul/blob/main/%E5%A4%A9%E9%94%90%E6%95%B0%E6%8D%AE%E6%B3%84%E9%9C%B2%E9%98%B2%E6%8A%A4%E7%B3%BB%E7%BB%9F-1.md.

To reduce your review burden, we will not repeat the details in this report.

## Vulnerability Analysis
Since MyBatis is used, we only need to perform a global search for `${` to find any oversights (unsecured parameters).

<img width="1520" height="189" alt="image" src="https://github.com/user-attachments/assets/0637c671-1e87-4d84-adea-d1cef0f3fe14" />

Let’s check the source of the parameter: `PageVo`.

<img width="1409" height="1244" alt="image" src="https://github.com/user-attachments/assets/c75a9874-f01c-494e-b6ec-c1cab4b79e59" />

This is an entity class. Theoretically, this class is used for front-end and back-end interaction, and its parameters are controllable by users.

Moreover, the `sort` parameter in this class is concatenated into `pageSql`, which is ultimately added to the aforementioned mapper, leading to injection. Therefore, it is clear that we just need to find which Controllers use this class.

We directly perform a global search for `import com.xxxx.bean.p000vo.PageVo` to see where this `PageVo` is applied.

The vulnerability exists in `com.trwfe.controller.FileServerController#findFileServerPage`.

<img width="1104" height="429" alt="image" src="https://github.com/user-attachments/assets/0cd4e6d5-ba81-4c8f-a6f8-9a67b5e03026" />

Let’s continue to trace further.

<img width="1421" height="970" alt="image" src="https://github.com/user-attachments/assets/31b2ab04-8ed3-44c3-b0c8-478be696728c" />

<img width="1911" height="450" alt="image" src="https://github.com/user-attachments/assets/e96b15d6-a1c6-4c38-b028-9bdbda8aa340" />

Next is the interaction with the mapper. Based on this, the Proof of Concept (POC) is constructed as follows:

<img width="1870" height="810" alt="image" src="https://github.com/user-attachments/assets/809810f7-c112-4f77-8290-adeeedfb64f8" />

Thus, the `findFileServerPage.do` interface has an SQL injection vulnerability.

Thank you for your review. Wish you a pleasant day!
